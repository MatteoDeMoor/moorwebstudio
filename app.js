const translations = {
  nl: {
    meta: {
      title: "Moor Webstudio – Simpele websites voor ondernemers.",
      description: "Ik ontwerp en bouw overzichtelijke websites zonder onnodige complexiteit.",
      ogTitle: "Moor Webstudio",
      ogDescription: "Simpele websites voor ondernemers.",
      twitterTitle: "Moor Webstudio",
      twitterDescription: "Simpele websites voor ondernemers.",
      schemaSlogan: "Simpele websites die werken."
    },
    nav: {
      home: "Home",
      services: "Diensten",
      process: "Werkwijze",
      pricing: "Pakketten",
      about: "Over mij",
      contact: "Contact",
      cta: "Plan een kennismaking",
      aria: "Hoofdnavigatie",
      menu: "Menu"
    },
    hero: {
      eyebrow: "ZELFSTANDIGE WEBBOUWER",
      subtitle: "Ik bouw duidelijke en betaalbare websites die passen bij jouw verhaal.",
      pitch: "Als éénmansstudio combineer ik design en front-end ontwikkeling om snelle, onderhoudsvrije sites op te leveren.",
      primaryCta: "Contact opnemen",
      secondaryCta: "Bekijk pakketten"
    },
    services: {
      eyebrow: "WAT IK VOOR JE DOE",
      title: "Simpele websites zonder gedoe",
      description: "Geen complexe backend of overbodige features: ik bouw overzichtelijke sites die makkelijk te beheren zijn.",
      webdesign: {
        title: "Website",
        text: "Een duidelijke website die klopt met jouw huisstijl en verhaal.",
        bullets: [
          "Ontwerp afgestemd op jouw huisstijl",
          "Structuur die jouw verhaal helder maakt",
          "Geoptimaliseerd voor mobiel en desktop"
        ]
      },
      development: {
        title: "Onderhoud",
        text: "Ik hou je site up-to-date zodat alles blijft werken zoals het hoort.",
        bullets: [
          "Inhoud en visuals aanpassen wanneer nodig",
          "Technische updates",
          "Snelle ondersteuning bij vragen"
        ]
      },
      optimization: {
        title: "Domein & hosting",
        text: "Geen gedoe met technische instellingen: ik regel domein en hosting voor je.",
        bullets: [
          "Registratie en beheer van je domeinnaam",
          "Betrouwbare hosting",
          "Monitoring van prestaties"
        ]
      }
    },
    process: {
      eyebrow: "WERKWIJZE",
      title: "Zo pakken we het samen aan",
      description: "Een persoonlijk traject met korte lijnen en duidelijke verwachtingen.",
      steps: [
        { title: "Kennismaking", text: "We bespreken jouw doelen en de inhoud die op de site moet komen." },
        { title: "Structuur", text: "Ik stel een sitemap en wireframes voor die passen bij een compacte website." },
        { title: "Eerste versie in code", text: "Ik bouw meteen in code en deel een klikbare versie zodat je alles kunt uitproberen." },
        { title: "Itereren tot het klopt", text: "We plannen korte feedbackrondes en sturen bij tot de site 100% goed voelt." },
        { title: "Oplevering", text: "We lopen alles samen door en ik zorg daarna voor het beheer en de updates." }
      ]
    },
    pricing: {
      eyebrow: "PAKKETTEN",
      title: "Kies wat bij je past",
      description: "Alle pakketten omvatten ontwerp, ontwikkeling en basisoptimalisatie.",
      featured: "Meest gekozen",
      cta: "Plan een kennismaking",
      plans: [
        {
          name: "Budget",
          price: "Vanaf €495",
          features: [
            "1 pagina",
            "Uniek design",
            "Responsive design"
          ]
        },
        {
          name: "Basic",
          price: "Vanaf €745",
          features: [
            "Max 5 pagina's",
            "Uniek design",
            "Responsive design"
          ]
        },
        {
          name: "Plus",
          price: "Vanaf €995",
          features: [
            "Max 10 pagina's",
            "Uniek design",
            "Responsive design"
          ]
        },
        {
          name: "Flex",
          price: "Op maat",
          features: [
            "Extra pagina's of functionaliteit",
            "Maandelijkse ondersteuning mogelijk",
            "Facturatie per maand of project"
          ]
        }
      ]
    },
    about: {
      eyebrow: "OVER MIJ",
      title: "Matteo De Moor",
      description: "Zelfstandig webbouwer en data engineer. Ik ben net afgestudeerd als Bachelor AI & Data Engineering aan HoGent en werk momenteel als data engineer. Daarnaast heb ik ook ervaring als data scientist.",
      linkedin: "Connect op LinkedIn",
      skills: ["HTML", "CSS", "JavaScript", "Python"],
      badges: [
        { value: "2025", label: "Bachelor AI & Data Engineering"},
        { value: "Data Engineer", label: "Huidige rol" }
      ]
    },
    testimonials: {
      eyebrow: "WERKWIJZE",
      title: "Nog geen reviews, wel transparantie",
      description: "Ik heb nog geen klantenquotes, dus vertel ik graag zelf hoe ik werk.",
      carouselAria: "Hoe ik werk slider",
      items: [
        {
          quote: "\"Je praat altijd rechtstreeks met mij: van eerste call tot de laatste pixel.\"",
          author: "Matteo De Moor"
        },
        {
          quote: "\"Ik lever snel op met duidelijke feedbackrondes zodat jij nooit hoeft te gissen naar de status.\"",
          author: "Matteo De Moor"
        },
        {
          quote: "\"Na oplevering blijf ik beschikbaar voor kleine updates of een flexibel vervolgtraject.\"",
          author: "Matteo De Moor"
        }
      ],
      prev: "Vorige highlight",
      next: "Volgende highlight"
    },
    contact: {
      eyebrow: "CONTACT",
      title: "Samen iets bouwen?",
      description: "Laat een bericht achter en ik neem persoonlijk contact met je op.",
      info: {
        title: "Direct mailen",
        text: "Stuur me gerust je idee of vraag.",
        email: "matteo.de.moor@skynet.be",
        phone: "",
        location: "Aalst, België"
      },
      form: {
        name: {
          label: "Naam",
          placeholder: "Jouw naam",
          error: "Vul je naam in."
        },
        email: {
          label: "E-mail",
          placeholder: "naam@bedrijf.com",
          error: "Gebruik een geldig e-mailadres."
        },
        company: {
          label: "Bedrijf (optioneel)",
          placeholder: "Bedrijfsnaam"
        },
        message: {
          label: "Bericht",
          placeholder: "Vertel iets over je project",
          error: "Beschrijf kort je project."
        },
        submit: "Verstuur bericht",
        success: "Bedankt! Ik kom snel bij je terug."
      }
    },
    footer: {
      tagline: "Simpele websites voor ondernemers.",
      links: "Snel naar",
      follow: "Volg Moor Webstudio",
      linkedin: "LinkedIn bedrijfspagina"
    }
  },
  en: {
    meta: {
      title: "Moor Webstudio – Simple websites for entrepreneurs.",
      description: "I design and build straightforward websites without unnecessary complexity.",
      ogTitle: "Moor Webstudio",
      ogDescription: "Simple websites for entrepreneurs.",
      twitterTitle: "Moor Webstudio",
      twitterDescription: "Simple websites for entrepreneurs.",
      schemaSlogan: "Simple websites that work."
    },
    nav: {
      home: "Home",
      services: "Services",
      process: "Process",
      pricing: "Packages",
      about: "About me",
      contact: "Contact",
      cta: "Book an intro call",
      aria: "Primary navigation",
      menu: "Menu"
    },
    hero: {
      eyebrow: "SOLO WEB CREATOR",
      subtitle: "I build clear and affordable websites that fit your story.",
      pitch: "As a one-person studio I combine design and front-end development to ship fast, maintenance-light sites.",
      primaryCta: "Get in touch",
      secondaryCta: "View packages"
    },
    services: {
      eyebrow: "WHAT I DO",
      title: "Simple websites without the bloat",
      description: "No heavy backends or unnecessary features—just clean sites that are easy to understand and maintain.",
      webdesign: {
        title: "Website",
        text: "A clear website that matches your brand identity and story.",
        bullets: [
          "Design aligned with your branding",
          "Structure that highlights your message",
          "Optimized for mobile and desktop"
        ]
      },
      development: {
        title: "Maintenance",
        text: "I keep your site up to date so everything keeps working smoothly.",
        bullets: [
          "Content and visuals updated when needed",
          "Technical updates",
          "Quick support whenever you need it"
        ]
      },
      optimization: {
        title: "Domain & hosting",
        text: "No hassle with technical settings: I arrange domain and hosting for you.",
        bullets: [
          "Domain registration and management",
          "Reliable hosting",
          "Monitoring of performance"
        ]
      }
    },
    process: {
      eyebrow: "PROCESS",
      title: "How we'll work together",
      description: "A personal, transparent journey with clear expectations.",
      steps: [
        { title: "Discovery", text: "We talk through your goals and gather the content for the site." },
        { title: "Structure", text: "I outline a concise sitemap and wireframes for a compact build." },
        { title: "First version in code", text: "I prototype directly in code so you can click through the real thing right away." },
        { title: "Iterate until it fits", text: "We run short feedback loops and keep refining until everything feels spot-on." },
        { title: "Launch", text: "We review everything together and I continue to take care of maintenance and updates." }
      ]
    },
    pricing: {
      eyebrow: "PACKAGES",
      title: "Pick what fits",
      description: "Every package includes design, development, and essential optimisation.",
      featured: "Most popular",
      cta: "Book an intro call",
      plans: [
        {
          name: "Budget",
          price: "From €495",
          features: [
            "1 page",
            "Unique design",
            "Responsive design"
          ]
        },
        {
          name: "Basic",
          price: "From €745",
          features: [
            "Up to 5 pages",
            "Unique design",
            "Responsive design"
          ]
        },
        {
          name: "Plus",
          price: "From €995",
          features: [
            "Up to 10 pages",
            "Unique design",
            "Responsive design"
          ]
        },
        {
          name: "Flex",
          price: "Custom",
          features: [
            "Additional pages or functionality",
            "Monthly support available",
            "Monthly or project-based billing"
          ]
        }
      ]
    },
    about: {
      eyebrow: "ABOUT",
      title: "Matteo De Moor",
      description: "Independent web creator with a data engineering focus. I'm currently working as a data engineer while graduating in 2025 with a BSc in AI & Data Engineering.",
      role: "Current role: data engineer translating pipelines into practical tools.",
      linkedin: "Connect on LinkedIn",
      skills: ["HTML", "CSS", "JavaScript", "Python", "Data engineering"],
      badges: [
        { value: "2025", label: "BSc AI & Data Engineering" },
        { value: "Data engineering", label: "Current role" }
      ]
    },
    testimonials: {
      eyebrow: "HOW I WORK",
      title: "No testimonials yet, just honesty",
      description: "I haven't worked with clients yet, so here's what you can expect when collaborating with me.",
      carouselAria: "How I work slider",
      items: [
        {
          quote: "\"You'll always speak directly with me—from first call to final tweaks.\"",
          author: "Matteo De Moor"
        },
        {
          quote: "\"I iterate quickly with clear feedback loops so you're never guessing about progress.\"",
          author: "Matteo De Moor"
        },
        {
          quote: "\"After launch I'm available for small updates or a flexible follow-up plan.\"",
          author: "Matteo De Moor"
        }
      ],
      prev: "Previous highlight",
      next: "Next highlight"
    },
    contact: {
      eyebrow: "CONTACT",
      title: "Ready to build together?",
      description: "Please leave a message and I will contact you personally.",
      info: {
        title: "Email directly",
        text: "Send over your idea or question.",
        email: "matteo.de.moor@skynet.be",
        phone: "",
        location: "Aalst, Belgium"
      },
      form: {
        name: {
          label: "Name",
          placeholder: "Your name",
          error: "Please enter your name."
        },
        email: {
          label: "Email",
          placeholder: "you@company.com",
          error: "Enter a valid email address."
        },
        company: {
          label: "Company (optional)",
          placeholder: "Company name"
        },
        message: {
          label: "Message",
          placeholder: "Tell me about your project",
          error: "Please describe your project."
        },
        submit: "Send message",
        success: "Thanks! I'll get back to you soon."
      }
    },
    footer: {
      tagline: "Simple websites for entrepreneurs.",
      links: "Quick links",
      follow: "Follow Moor Webstudio",
      linkedin: "LinkedIn company page"
    }
  }
};

const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

const languageButtons = document.querySelectorAll('.language-toggle__button');
const rootElement = document.documentElement;
const nav = document.querySelector('.nav');
const navMenu = document.querySelector('.nav__menu');
const navToggle = document.querySelector('.nav__toggle');
const navLinks = document.querySelectorAll('.nav__link');
const sections = document.querySelectorAll('main section');
const portfolioFilters = document.querySelectorAll('.portfolio__filter');
const portfolioCards = document.querySelectorAll('.portfolio-card');
const counterElements = document.querySelectorAll('.portfolio-highlight__number');
const processSteps = document.querySelectorAll('.process-step');
const testimonialTrack = document.querySelector('.testimonial-slider__track');
const testimonialSlides = document.querySelectorAll('.testimonial');
const testimonialButtons = document.querySelectorAll('.testimonial-slider__button');
const contactForm = document.querySelector('.contact-form');
const schemaScript = document.getElementById('organization-schema');
const sliderContainer = document.querySelector('.testimonial-slider');

const storedLang = localStorage.getItem('moorsites-lang') || localStorage.getItem('ogoconcept-lang');
let activeLang = storedLang || 'nl';
let currentSlide = 0;
let sliderInterval;

const updateMetaTags = (langKey) => {
  const meta = translations[langKey].meta;
  document.title = meta.title;
  const descriptionTag = document.querySelector('meta[name="description"]');
  if (descriptionTag) descriptionTag.setAttribute('content', meta.description);
  const ogTitle = document.querySelector('meta[property="og:title"]');
  const ogDescription = document.querySelector('meta[property="og:description"]');
  const twitterTitle = document.querySelector('meta[name="twitter:title"]');
  const twitterDescription = document.querySelector('meta[name="twitter:description"]');
  if (ogTitle) ogTitle.setAttribute('content', meta.ogTitle);
  if (ogDescription) ogDescription.setAttribute('content', meta.ogDescription);
  if (twitterTitle) twitterTitle.setAttribute('content', meta.twitterTitle);
  if (twitterDescription) twitterDescription.setAttribute('content', meta.twitterDescription);
  if (schemaScript) {
    try {
      const schema = JSON.parse(schemaScript.textContent);
      schema.slogan = meta.schemaSlogan;
      schemaScript.textContent = JSON.stringify(schema, null, 2);
    } catch (error) {
      console.error('Schema update failed', error);
    }
  }
};

const applyTranslations = (langKey) => {
  const dictionary = translations[langKey];
  document.querySelectorAll('[data-i18n]').forEach((node) => {
    const keys = node.dataset.i18n.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      node.textContent = value;
    } else if (Array.isArray(value)) {
      // handle arrays for list items
      const children = node.querySelectorAll('[data-i18n-array-item]');
      value.forEach((text, index) => {
        const child = children[index];
        if (child) child.textContent = text;
      });
    }
  });

  document.querySelectorAll('[data-placeholder]').forEach((input) => {
    const keys = input.dataset.placeholder.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      input.setAttribute('placeholder', value);
    }
  });

  document.querySelectorAll('option[data-i18n]').forEach((option) => {
    const keys = option.dataset.i18n.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      option.textContent = value;
    }
  });

  document.querySelectorAll('[data-i18n-hover]').forEach((node) => {
    const keys = node.dataset.i18nHover.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      node.setAttribute('data-hover', value);
      node.setAttribute('data-label', value);
    }
  });

  const navElement = document.querySelector('nav[aria-label]');
  if (navElement) {
    navElement.setAttribute('aria-label', dictionary.nav.aria);
  }
  if (navToggle) {
    navToggle.setAttribute('aria-label', dictionary.nav.menu);
  }
  if (sliderContainer) {
    sliderContainer.setAttribute('aria-label', dictionary.testimonials.carouselAria);
  }
  testimonialButtons.forEach((button) => {
    const direction = button.dataset.direction;
    const label = direction === 'prev' ? dictionary.testimonials.prev : dictionary.testimonials.next;
    button.setAttribute('aria-label', label);
  });

  document.querySelectorAll('a[href^="mailto:"]').forEach((link) => {
    if (dictionary.contact?.info?.email) {
      link.textContent = dictionary.contact.info.email;
    }
  });
  document.querySelectorAll('a[href^="tel:"]').forEach((link) => {
    if (dictionary.contact?.info?.phone) {
      link.textContent = dictionary.contact.info.phone;
    }
  });

  const locationNode = document.querySelector('.contact__info-list li:last-child');
  if (locationNode) {
    locationNode.textContent = dictionary.contact.info.location;
  }

  document.querySelectorAll('.about__badge').forEach((badge, index) => {
    const valueNode = badge.querySelector('.about__badge-number');
    const labelNode = badge.querySelector('.about__badge-label');
    const data = dictionary.about.badges[index];
    if (data) {
      if (valueNode) valueNode.textContent = data.value;
      if (labelNode) labelNode.textContent = data.label;
    }
  });

  document.querySelectorAll('.about__skills li').forEach((item, index) => {
    const value = dictionary.about.skills[index];
    if (value) item.textContent = value;
  });

  document.querySelectorAll('.service-card').forEach((card, index) => {
    const serviceKey = ['webdesign', 'development', 'optimization'][index];
    if (!serviceKey) return;
    const serviceData = dictionary.services[serviceKey];
    if (!serviceData) return;
    const bulletItems = card.querySelectorAll('.service-card__list li');
    serviceData.bullets.forEach((text, bulletIndex) => {
      const bullet = bulletItems[bulletIndex];
      if (bullet) bullet.textContent = text;
    });
  });

  if (dictionary.portfolio?.items) {
    portfolioCards.forEach((card, index) => {
      const data = dictionary.portfolio.items[index];
      if (!data) return;
      const tags = card.querySelectorAll('.portfolio-card__tags li');
      tags.forEach((tag, tagIndex) => {
        tag.textContent = data.tags[tagIndex] || '';
      });
    });
  }

  document.querySelectorAll('.pricing-card').forEach((card, index) => {
    const planData = dictionary.pricing.plans[index];
    if (!planData) return;
    const features = card.querySelectorAll('.pricing-card__features li');
    features.forEach((feature, featureIndex) => {
      feature.textContent = planData.features[featureIndex] || '';
    });
  });

  testimonialSlides.forEach((slide, index) => {
    const quoteNode = slide.querySelector('.testimonial__quote');
    const authorNode = slide.querySelector('.testimonial__author');
    const data = dictionary.testimonials.items[index];
    if (data) {
      if (quoteNode) quoteNode.textContent = data.quote;
      if (authorNode) authorNode.textContent = data.author;
    }
  });

  document.querySelectorAll('.contact-form__error').forEach((errorNode) => {
    const keys = errorNode.dataset.i18n.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      errorNode.textContent = value;
    }
  });

  const successNode = document.querySelector('.contact-form__success');
  if (successNode) {
    const keys = successNode.dataset.i18n.split('.');
    let value = dictionary;
    for (const key of keys) {
      value = value?.[key];
    }
    if (typeof value === 'string') {
      successNode.textContent = value;
    }
  }

  updateMetaTags(langKey);
};

const setLanguage = (langKey) => {
  activeLang = langKey;
  rootElement.lang = langKey;
  languageButtons.forEach((button) => {
    const isActive = button.dataset.lang === langKey;
    button.classList.toggle('is-active', isActive);
    button.setAttribute('aria-pressed', String(isActive));
  });
  applyTranslations(langKey);
  localStorage.setItem('moorsites-lang', langKey);
  localStorage.removeItem('ogoconcept-lang');
};

languageButtons.forEach((button) => {
  button.addEventListener('click', () => setLanguage(button.dataset.lang));
});

const setNavScrolled = () => {
  if (!nav) return;
  nav.classList.toggle('is-scrolled', window.scrollY > 20);
};

const closeMenu = () => {
  navMenu.classList.remove('is-open');
  navToggle.setAttribute('aria-expanded', 'false');
};

if (navToggle) {
  navToggle.addEventListener('click', () => {
    const isOpen = navMenu.classList.toggle('is-open');
    navToggle.setAttribute('aria-expanded', String(isOpen));
  });
}

navLinks.forEach((link) => {
  link.addEventListener('click', () => {
    if (window.innerWidth <= 960) {
      closeMenu();
    }
  });
});

window.addEventListener('scroll', setNavScrolled);
setNavScrolled();

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      const id = entry.target.getAttribute('id');
      navLinks.forEach((link) => {
        const href = link.getAttribute('href');
        const matches = href === `#${id}`;
        link.classList.toggle('is-active', matches);
      });
    }
  });
}, { threshold: 0.5 });

sections.forEach((section) => observer.observe(section));

if (!prefersReducedMotion) {
  const counterObserver = new IntersectionObserver((entries, obs) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const node = entry.target;
        const target = parseInt(node.dataset.target, 10);
        let current = 0;
        const increment = Math.ceil(target / 50);
        const updateCounter = () => {
          current += increment;
          if (current >= target) {
            node.textContent = `${target}%`;
            clearInterval(timer);
          } else {
            node.textContent = `${current}%`;
          }
        };
        const timer = setInterval(updateCounter, 30);
        obs.unobserve(node);
      }
    });
  }, { threshold: 0.5 });

  counterElements.forEach((element) => counterObserver.observe(element));
}

const processObserver = new IntersectionObserver((entries, obs) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      entry.target.classList.add('is-visible');
      obs.unobserve(entry.target);
    }
  });
}, { threshold: 0.3 });

processSteps.forEach((step) => processObserver.observe(step));

portfolioFilters.forEach((button) => {
  button.addEventListener('click', () => {
    portfolioFilters.forEach((btn) => btn.classList.remove('is-active'));
    button.classList.add('is-active');
    const filter = button.dataset.filter;
    portfolioCards.forEach((card) => {
      const match = filter === 'all' || card.dataset.category === filter;
      card.style.display = match ? '' : 'none';
    });
  });
});

const moveSlider = (direction) => {
  const totalSlides = testimonialSlides.length;
  currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
  testimonialTrack.style.transform = `translateX(-${currentSlide * 100}%)`;
};

testimonialButtons.forEach((button) => {
  button.addEventListener('click', () => {
    const direction = button.dataset.direction === 'next' ? 1 : -1;
    moveSlider(direction);
    restartSlider();
  });
});

const startSlider = () => {
  if (prefersReducedMotion) return;
  sliderInterval = setInterval(() => moveSlider(1), 6000);
};

const restartSlider = () => {
  if (sliderInterval) clearInterval(sliderInterval);
  startSlider();
};

if (sliderContainer) {
  sliderContainer.addEventListener('mouseenter', () => sliderInterval && clearInterval(sliderInterval));
  sliderContainer.addEventListener('mouseleave', restartSlider);
}

startSlider();

if (prefersReducedMotion) {
  processSteps.forEach((step) => step.classList.add('is-visible'));
}

const validateField = (input) => {
  const group = input.closest('.contact-form__group');
  if (!group) return true;
  const errorNode = group.querySelector('.contact-form__error');
  let isValid = true;

  if (input.type === 'email') {
    isValid = input.value.trim() !== '' && input.checkValidity();
  } else if (input.tagName === 'SELECT') {
    isValid = input.value.trim() !== '';
  } else if (input.hasAttribute('required')) {
    isValid = input.value.trim() !== '';
  }

  if (!isValid) {
    errorNode?.classList.add('is-visible');
  } else {
    errorNode?.classList.remove('is-visible');
  }
  return isValid;
};

contactForm?.querySelectorAll('input, textarea, select').forEach((field) => {
  field.addEventListener('blur', () => validateField(field));
});

if (typeof window !== 'undefined') {
  window.moorsitesValidateContactForm = () => {
    if (!contactForm) return true;
    let formIsValid = true;
    const fields = contactForm.querySelectorAll('input, textarea, select');
    fields.forEach((field) => {
      if (!validateField(field)) {
        formIsValid = false;
      }
    });
    return formIsValid;
  };

  window.moorsitesClearContactFormState = () => {
    if (!contactForm) return;
    const fields = contactForm.querySelectorAll('input, textarea, select');
    fields.forEach((field) => {
      const group = field.closest('.contact-form__group');
      group?.querySelector('.contact-form__error')?.classList.remove('is-visible');
    });
  };
}

const yearNode = document.getElementById('current-year');
if (yearNode) {
  yearNode.textContent = new Date().getFullYear();
}

setLanguage(activeLang);
if (navLinks.length) {
  navLinks[0].classList.add('is-active');
}
